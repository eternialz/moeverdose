<%= form_for @post, url: posts_path, html: {class: "upload clearfix"} do |f| %>
  <div id="file_upload">
    <%= f.file_field :post_image, required: "required" %>
    <div class="file-dummy">
      <span class="success">Nice! <br /><span id="message">Please respect the rules for posts while uploading</span></span>
      <span class="normal"><%= fa_icon "image" %> Click to select the image or drop it here<br /><span id="message">waiting for image...</span></span>
    </div>
    <img id="file"/>
  </div>
  <div id="info_upload" class="row">
    <div class="header column f4">
      <h3><%= fa_icon "header" %> Title<span class="required">required</span></h3>
      <input type="text" name="post[title]" placeholder='Title'></textarea>
    </div>
    <div class="authors column f4">
      <h3><%= fa_icon "user" %> Author<span class="required">required</span></h3>
      <input type="text" name="post[tags]" placeholder='Author ("hayao_miyazaki")'></textarea>
    </div>
    <div class="source column f4">
      <h3 class="yellow"><%= fa_icon "rss" %> Source</h3>
      <input type="text" name="post[tags]" placeholder='Author ("hayao_miyazaki")'></textarea>
    </div>
    <div class="tags column f6">
      <h3><%= fa_icon "tag" %> Tags<span class="required">required (at least three)</span></h3>
      <textarea name="tags" placeholder='Tags ("1girl glasses")'></textarea>
    </div>
    <div class="characters column f6">
      <h3><%= fa_icon "group" %> Character(s)</h3>
      <textarea placeholder='Character(s) ("illyasviel_von_einzbern")'></textarea>
    </div>
  </div>
  <div style="text-align:center;">
    <input type="submit" class="btn" value="Upload">
  </div>
<% end %>

<script>
function readURL(input) {

    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#file').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
}

$("#post_post_image").change(function(){
    readURL(this);
});
</script>
